policies:
  - name: azure-storage-enforce-secure-transfer
    resource: azure.storage
    description: "Enforces secure transfer (HTTPS) on new storage accounts."
    mode:
      type: azure-event-grid
      events:
        - resourceProvider: "Microsoft.Storage/storageAccounts"
          event: "write"
      provision-options:
        identity:
          type: SystemAssigned
    filters:
      - type: value
        key: properties.supportsHttpsTrafficOnly
        value: false
    actions:
      - type: require-secure-transfer
        value: true
