{
  "policy": {
    "name": "aws-sg-mark-insecure",
    "resource": "aws.security-group",
    "description": "Marks any Security Group allowing SSH (22) or RDP (3389) from 0.0.0.0/0 for remediation in 5 minutes.",
    "mode": {
      "type": "cloudtrail",
      "events": [
        {
          "source": "ec2.amazonaws.com",
          "event": "AuthorizeSecurityGroupIngress",
          "ids": "responseElements.securityGroupRuleSet.items[].groupId"
        }
      ],
      "role": "arn:aws:iam::391183495225:role/Aegis-Governance-Role",
      "tags": {
        "custodian-info": "mode=cloudtrail:version=0.9.48"
      }
    },
    "filters": [
      {
        "or": [
          {
            "type": "ingress",
            "Cidr": "0.0.0.0/0",
            "Ports": [
              22,
              3389
            ]
          }
        ]
      }
    ],
    "actions": [
      {
        "type": "mark-for-op",
        "op": "remove-permissions",
        "tag": "custodian_cleanup",
        "hours": 0.034
      }
    ]
  },
  "version": "0.9.48",
  "execution": {
    "id": "f6aff4a8-b303-40ee-b456-c8938a36be3c",
    "start": 1768418862.851133,
    "end_time": 1768418876.5715637,
    "duration": 13.720430612564087
  },
  "config": {
    "region": "us-east-1",
    "regions": [
      "us-east-1"
    ],
    "cache": "~/.cache/cloud-custodian.cache",
    "profile": null,
    "account_id": "391183495225",
    "assume_role": null,
    "session_policy": null,
    "external_id": null,
    "log_group": null,
    "tracer": null,
    "metrics_enabled": null,
    "metrics": null,
    "output_dir": ".",
    "cache_period": 15,
    "dryrun": false,
    "authorization_file": null,
    "subparser": "run",
    "config": null,
    "configs": [
      "policies/aws-security-enforcer.yml"
    ],
    "policy_filters": [],
    "resource_types": [],
    "verbose": null,
    "quiet": null,
    "debug": false,
    "skip_validation": false,
    "command": "c7n.commands.run",
    "vars": null
  },
  "sys-stats": {
    "snapshot_time": 13.721715450286865,
    "num_fds": 2,
    "cpu_user": 0.6499999999999999,
    "cpu_system": 0.06,
    "num_ctx_switches_voluntary": 31,
    "num_ctx_switches_involuntary": 2,
    "read_count": 731,
    "write_count": 517,
    "write_bytes": 692224,
    "rss": -6053888,
    "vms": -6287360,
    "data": -6287360
  },
  "api-stats": {
    "lambda.GetFunction": 1,
    "lambda.UpdateFunctionCode": 1,
    "lambda.GetFunctionConfiguration": 2,
    "events.DescribeRule": 1,
    "lambda.AddPermission": 1,
    "events.ListTargetsByRule": 1
  },
  "metrics": []
}